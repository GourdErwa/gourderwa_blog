<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>


<script>

    var data = [
        {
            "id": 1,
            "pid": 0,
            "name": "权限管理",
            "accrss": "quanxian",
            "type": "backend"
        },
        {
            "id": 2,
            "pid": 1,
            "name": "数据权限",
            "accrss": "quanxian/shuju",
            "type": "backend"
        },
        {
            "id": 3,
            "pid": 1,
            "name": "操作权限",
            "accrss": "quanxian/caozuo",
            "type": "backend"
        },
        {
            "id": 4,
            "pid": 3,
            "name": "渠道操作权限",
            "accrss": "quanxian/caozuo/qvdao",
            "type": "backend"
        },
        {
            "id": 5,
            "pid": 3,
            "name": "区服操作权限",
            "accrss": "quanxian/caozuo/qvfu",
            "type": "backend"
        },
        {
            "id": 6,
            "pid": 0,
            "name": "用户管理",
            "accrss": "quanxian",
            "type": "backend"
        },
        {
            "id": 7,
            "pid": 6,
            "name": "管理员",
            "accrss": "quanxian/shuju",
            "type": "backend"
        },
        {
            "id": 8,
            "pid": 6,
            "name": "非管理员用户",
            "accrss": "quanxian/caozuo",
            "type": "backend"
        },
        {
            "id": 9,
            "pid": 8,
            "name": "数据用户",
            "accrss": "quanxian/caozuo/qvdao",
            "type": "backend"
        },
        {
            "id": 10,
            "pid": 8,
            "name": "操作用户",
            "accrss": "quanxian/caozuo/qvfu",
            "type": "backend"
        }
    ];


    /**
     * @param defaultPid 默认根目录父 ID 值
     * @param treeData 待处理树原始数据
     * @constructor
     */
    function TreeNode(defaultPid, treeData) {

        this.treeData = treeData || [];

        /**
         * @returns {Array} 原始数据中 root 节点数据
         */
        this.findRoot = function () {
            var r = [];
            this.treeData.forEach(function (v, i) {
                if (v.pid === defaultPid) {
                    v.deep = 0;
                    v.parentName = "";
                    v.rootName = v.name;
                    r.push(v);
                }
            });

            return r;
        };

        /**
         *
         * @param result 返回数组 []
         * @param parentNode 待寻找根节点
         * @returns {*|Array} 返回该父节点下所有子节点
         */
        this.findChildOfParentNode = function (result, parentNode) {

            result = result || [];
            if (!parentNode) {
                return result;
            }

            var t = this;
            //待寻找父 id
            var oPid = parentNode.id;
            this.treeData.forEach(function (p, i) {
                if (p.pid === oPid) {
                    p.deep = parentNode.deep + 1;
                    p.parentName = parentNode.parentName + "/" + parentNode.name;
                    p.rootName = parentNode.rootName;
                    result.push(p);
                    t.findChildOfParentNode(result, p);
                }
            });
        };

        /**
         * @returns {Array} 转换后树的结构
         */
        this.findAll = function () {
            var r = this.findRoot();
            var t = this;
            r.forEach(function (v, i) {
                t.findChildOfParentNode(r, v);
            });

            return r;
        };

    }
    console.log("----------------------处理前-----------------------------");
    console.table(data);


    console.log("----------------------处理后-----------------------------");
    var treeNode = new TreeNode(0, data);
    var r = treeNode.findAll();
    console.table(r);


</script>
</body>
</html>